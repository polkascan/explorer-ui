/*
 * Polkascan Explorer UI
 * Copyright (C) 2018-2022 Polkascan Foundation (NL)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

import { Injectable } from '@angular/core';
import { PolkadaptService } from './polkadapt.service';
import { BehaviorSubject, ReplaySubject, Subject } from 'rxjs';
import { VariablesService } from './variables.service';



const test: [number, number][] = [
    [
        1597795200000,
        2.9366649977840584
    ],
    [
        1597881600000,
        2.9366649977840584
    ],
    [
        1597968000000,
        2.89879087042457
    ],
    [
        1598054400000,
        2.8719231582885576
    ],
    [
        1598140800000,
        4.481388823739925
    ],
    [
        1598227200000,
        3.9660827659100875
    ],
    [
        1598313600000,
        4.576939499077849
    ],
    [
        1598400000000,
        5.49394714760662
    ],
    [
        1598486400000,
        6.067730199404114
    ],
    [
        1598572800000,
        5.6385306333733185
    ],
    [
        1598659200000,
        6.1623228698425585
    ],
    [
        1598745600000,
        6.148507935787226
    ],
    [
        1598832000000,
        5.901759394871453
    ],
    [
        1598918400000,
        6.29879772167723
    ],
    [
        1599004800000,
        6.229619252395945
    ],
    [
        1599091200000,
        6.158884269227721
    ],
    [
        1599177600000,
        5.683421169603046
    ],
    [
        1599264000000,
        5.1340152181772725
    ],
    [
        1599350400000,
        4.13019788733723
    ],
    [
        1599436800000,
        4.78962789693905
    ],
    [
        1599523200000,
        4.5949309096714614
    ],
    [
        1599609600000,
        4.282524684960109
    ],
    [
        1599696000000,
        4.703108697943335
    ],
    [
        1599782400000,
        4.577765287676936
    ],
    [
        1599868800000,
        4.625864199988795
    ],
    [
        1599955200000,
        5.139290011153086
    ],
    [
        1600041600000,
        5.294815256024742
    ],
    [
        1600128000000,
        5.339198957352251
    ],
    [
        1600214400000,
        5.113838698353973
    ],
    [
        1600300800000,
        5.075261806582743
    ],
    [
        1600387200000,
        5.323352024016255
    ],
    [
        1600473600000,
        5.242095138770248
    ],
    [
        1600560000000,
        4.924359684930011
    ],
    [
        1600646400000,
        4.673545848129287
    ],
    [
        1600732800000,
        4.089749652347997
    ],
    [
        1600819200000,
        4.168355680932848
    ],
    [
        1600905600000,
        4.0160363563658406
    ],
    [
        1600992000000,
        4.389748821648701
    ],
    [
        1601078400000,
        4.41286272780764
    ],
    [
        1601164800000,
        4.340299971503735
    ],
    [
        1601251200000,
        4.306460643533152
    ],
    [
        1601337600000,
        4.420033114111349
    ],
    [
        1601424000000,
        4.491527362227763
    ],
    [
        1601510400000,
        4.347197258520258
    ],
    [
        1601596800000,
        4.338624033430472
    ],
    [
        1601683200000,
        4.122609864205513
    ],
    [
        1601769600000,
        4.066948359187792
    ],
    [
        1601856000000,
        4.176764230629664
    ],
    [
        1601942400000,
        4.1602369454029935
    ],
    [
        1602028800000,
        3.7488354717069563
    ],
    [
        1602115200000,
        3.852999443688667
    ],
    [
        1602201600000,
        4.101843106713311
    ],
    [
        1602288000000,
        4.258895921902619
    ],
    [
        1602374400000,
        4.254212996164335
    ],
    [
        1602460800000,
        4.250188243961778
    ],
    [
        1602547200000,
        4.316288996695248
    ],
    [
        1602633600000,
        4.248906706000911
    ],
    [
        1602720000000,
        4.1946440236628275
    ],
    [
        1602806400000,
        4.094854852342111
    ],
    [
        1602892800000,
        3.902291340576514
    ],
    [
        1602979200000,
        3.9644790925219424
    ],
    [
        1603065600000,
        4.106552351478096
    ],
    [
        1603152000000,
        3.991640613782067
    ],
    [
        1603238400000,
        3.9071668227555576
    ],
    [
        1603324800000,
        4.13130490955701
    ],
    [
        1603411200000,
        4.264652281323652
    ],
    [
        1603497600000,
        4.256187304957874
    ],
    [
        1603584000000,
        4.350430279896141
    ],
    [
        1603670400000,
        4.3340414314672575
    ],
    [
        1603756800000,
        4.687976438792263
    ],
    [
        1603843200000,
        4.682587970002437
    ],
    [
        1603929600000,
        4.360419431708068
    ],
    [
        1604016000000,
        4.0535048878831885
    ],
    [
        1604102400000,
        4.090725680953809
    ],
    [
        1604188800000,
        4.178017676018528
    ],
    [
        1604275200000,
        4.2018859212030994
    ],
    [
        1604361600000,
        4.02450724653999
    ],
    [
        1604448000000,
        4.025233393564967
    ],
    [
        1604534400000,
        4.08136926366573
    ],
    [
        1604620800000,
        4.2330784917447986
    ],
    [
        1604707200000,
        4.570121705410882
    ],
    [
        1604793600000,
        4.237073500377915
    ],
    [
        1604880000000,
        4.36318980541015
    ],
    [
        1604966400000,
        4.339818011981211
    ],
    [
        1605052800000,
        4.409560532264164
    ],
    [
        1605139200000,
        4.4487908956058995
    ],
    [
        1605225600000,
        4.387897880183851
    ],
    [
        1605312000000,
        4.543670476701079
    ],
    [
        1605398400000,
        4.467036595848679
    ],
    [
        1605484800000,
        4.371535464067909
    ],
    [
        1605571200000,
        4.489781697889019
    ],
    [
        1605657600000,
        4.830331992396186
    ],
    [
        1605744000000,
        4.685764153907629
    ],
    [
        1605830400000,
        4.754053430688043
    ],
    [
        1605916800000,
        5.2291137797130105
    ],
    [
        1606003200000,
        5.757536694549964
    ],
    [
        1606089600000,
        5.494676717392706
    ],
    [
        1606176000000,
        5.895639961337506
    ],
    [
        1606262400000,
        5.7134397129088965
    ],
    [
        1606348800000,
        5.304069822023128
    ],
    [
        1606435200000,
        4.799368169183063
    ],
    [
        1606521600000,
        4.789256503946778
    ],
    [
        1606608000000,
        4.889793511050391
    ],
    [
        1606694400000,
        5.185800478185966
    ],
    [
        1606780800000,
        5.354461939485786
    ],
    [
        1606867200000,
        5.103662736678471
    ],
    [
        1606953600000,
        5.4791688023995855
    ],
    [
        1607040000000,
        5.410465394503286
    ],
    [
        1607126400000,
        5.050151461894864
    ],
    [
        1607212800000,
        5.192111883448054
    ],
    [
        1607299200000,
        5.1276943188376345
    ],
    [
        1607385600000,
        5.060144766864494
    ],
    [
        1607472000000,
        4.739434958246353
    ],
    [
        1607558400000,
        4.863467872055046
    ],
    [
        1607644800000,
        4.799326849064115
    ],
    [
        1607731200000,
        4.627222115400451
    ],
    [
        1607817600000,
        4.737725656552705
    ],
    [
        1607904000000,
        4.8891194895528125
    ],
    [
        1607990400000,
        4.898343040590993
    ],
    [
        1608076800000,
        5.262614123384493
    ],
    [
        1608163200000,
        5.358418752997773
    ],
    [
        1608249600000,
        5.346437615969691
    ],
    [
        1608336000000,
        5.3643097792530385
    ],
    [
        1608422400000,
        5.338112956518199
    ],
    [
        1608508800000,
        5.182239119670477
    ],
    [
        1608595200000,
        4.892651644964082
    ],
    [
        1608681600000,
        5.153342961453958
    ],
    [
        1608768000000,
        4.738927848976903
    ],
    [
        1608854400000,
        5.135446440741811
    ],
    [
        1608940800000,
        5.211168044078331
    ],
    [
        1609027200000,
        5.211078203647316
    ],
    [
        1609113600000,
        5.170288678373178
    ],
    [
        1609200000000,
        6.609020866254324
    ],
    [
        1609286400000,
        7.574707918682685
    ],
    [
        1609372800000,
        7.279015190253465
    ],
    [
        1609459200000,
        9.361037070164066
    ],
    [
        1609545600000,
        8.309384385343932
    ],
    [
        1609632000000,
        9.223083455454598
    ],
    [
        1609718400000,
        10.27944456603755
    ],
    [
        1609804800000,
        9.259346327220705
    ],
    [
        1609891200000,
        9.739198196297945
    ],
    [
        1609977600000,
        10.097684412122385
    ],
    [
        1610064000000,
        9.646132180213604
    ],
    [
        1610150400000,
        9.314730658380785
    ],
    [
        1610236800000,
        9.778410809521537
    ],
    [
        1610323200000,
        9.32941019974151
    ],
    [
        1610409600000,
        8.288132976060027
    ],
    [
        1610496000000,
        8.263019571221426
    ],
    [
        1610582400000,
        11.02499584700394
    ],
    [
        1610668800000,
        14.38916681553055
    ],
    [
        1610755200000,
        13.197430651795004
    ],
    [
        1610841600000,
        18.284968089036074
    ],
    [
        1610928000000,
        16.941180662094123
    ],
    [
        1611014400000,
        16.417059963410804
    ],
    [
        1611100800000,
        16.500379490310053
    ],
    [
        1611187200000,
        17.970988693677562
    ],
    [
        1611273600000,
        16.003304708570408
    ],
    [
        1611360000000,
        17.15345552433555
    ],
    [
        1611446400000,
        18.600319045809094
    ],
    [
        1611532800000,
        17.99637972827149
    ],
    [
        1611619200000,
        17.255294680478368
    ],
    [
        1611705600000,
        17.114219195402026
    ],
    [
        1611792000000,
        15.458076344001169
    ],
    [
        1611878400000,
        16.953589906577026
    ],
    [
        1611964800000,
        16.813221319825903
    ],
    [
        1612051200000,
        16.436802315990118
    ],
    [
        1612137600000,
        16.14345479897933
    ],
    [
        1612224000000,
        16.334468233166803
    ],
    [
        1612310400000,
        17.246208880683334
    ],
    [
        1612396800000,
        20.81123989919261
    ],
    [
        1612483200000,
        19.687856290916976
    ],
    [
        1612569600000,
        20.91552499982878
    ],
    [
        1612656000000,
        20.398566658141082
    ],
    [
        1612742400000,
        19.686716214362857
    ],
    [
        1612828800000,
        23.104852396172653
    ],
    [
        1612915200000,
        23.177174086708273
    ],
    [
        1613001600000,
        23.533187894020454
    ],
    [
        1613088000000,
        25.11602680817384
    ],
    [
        1613174400000,
        28.637121005864973
    ],
    [
        1613260800000,
        27.947634813017714
    ],
    [
        1613347200000,
        27.052949735557565
    ],
    [
        1613433600000,
        27.686623199565354
    ],
    [
        1613520000000,
        30.19801882921414
    ],
    [
        1613606400000,
        31.93217512022303
    ],
    [
        1613692800000,
        31.16279213534729
    ],
    [
        1613779200000,
        35.02642927738189
    ],
    [
        1613865600000,
        39.37357824214819
    ],
    [
        1613952000000,
        39.722197469433084
    ],
    [
        1614038400000,
        37.817806817149155
    ],
    [
        1614124800000,
        34.39389978147767
    ],
    [
        1614211200000,
        33.728701680774485
    ],
    [
        1614297600000,
        31.18993528588956
    ],
    [
        1614384000000,
        31.374676906050965
    ],
    [
        1614470400000,
        33.804127649421545
    ],
    [
        1614556800000,
        33.453163322797664
    ],
    [
        1614643200000,
        35.572923823083045
    ],
    [
        1614729600000,
        36.273412651568634
    ],
    [
        1614816000000,
        37.07636012738535
    ],
    [
        1614902400000,
        35.413922185913535
    ],
    [
        1614988800000,
        33.72448813423524
    ],
    [
        1615075200000,
        33.493545963177105
    ],
    [
        1615161600000,
        35.244068617208505
    ],
    [
        1615248000000,
        34.97150748636119
    ],
    [
        1615334400000,
        38.39566561239021
    ],
    [
        1615420800000,
        37.77983958064008
    ],
    [
        1615507200000,
        36.87831206918232
    ],
    [
        1615593600000,
        35.707556770344794
    ],
    [
        1615680000000,
        37.31727832816065
    ],
    [
        1615766400000,
        36.72597695065916
    ],
    [
        1615852800000,
        34.35379402477465
    ],
    [
        1615939200000,
        35.65040902655968
    ],
    [
        1616025600000,
        36.29445282846255
    ],
    [
        1616112000000,
        35.52301948450725
    ],
    [
        1616198400000,
        38.21625368340663
    ],
    [
        1616284800000,
        37.504844437877956
    ],
    [
        1616371200000,
        36.765101684857974
    ],
    [
        1616457600000,
        35.517977330046804
    ],
    [
        1616544000000,
        34.28626821871331
    ],
    [
        1616630400000,
        30.570941813601564
    ],
    [
        1616716800000,
        29.710342331197918
    ],
    [
        1616803200000,
        33.12929964007773
    ],
    [
        1616889600000,
        32.623518813998444
    ],
    [
        1616976000000,
        32.170750958622584
    ],
    [
        1617062400000,
        34.326400141737494
    ],
    [
        1617148800000,
        33.925085875005024
    ],
    [
        1617235200000,
        36.88846964991404
    ],
    [
        1617321600000,
        37.62466260171384
    ],
    [
        1617408000000,
        40.9438709604607
    ],
    [
        1617494400000,
        41.70150320376947
    ],
    [
        1617580800000,
        44.23991890458163
    ],
    [
        1617667200000,
        45.608300004049674
    ],
    [
        1617753600000,
        43.42494300781044
    ],
    [
        1617840000000,
        39.7504883353942
    ],
    [
        1617926400000,
        41.40897804173473
    ],
    [
        1618012800000,
        40.78441349825649
    ],
    [
        1618099200000,
        41.59194183003013
    ],
    [
        1618185600000,
        41.37856473210077
    ],
    [
        1618272000000,
        40.5573365714278
    ],
    [
        1618358400000,
        43.222210275480606
    ],
    [
        1618444800000,
        42.49790062069117
    ],
    [
        1618531200000,
        43.52043820016024
    ],
    [
        1618617600000,
        41.51273907303092
    ],
    [
        1618704000000,
        42.40896113698797
    ],
    [
        1618790400000,
        37.3734056067233
    ],
    [
        1618876800000,
        34.82115668267041
    ],
    [
        1618963200000,
        35.414477916826065
    ],
    [
        1619049600000,
        34.01561845397449
    ],
    [
        1619136000000,
        33.24205546321306
    ],
    [
        1619222400000,
        32.377708870905025
    ],
    [
        1619308800000,
        29.138478823748244
    ],
    [
        1619395200000,
        29.77071633647868
    ],
    [
        1619481600000,
        33.46053388171351
    ],
    [
        1619568000000,
        34.538588734933114
    ],
    [
        1619654400000,
        33.99294723198461
    ],
    [
        1619740800000,
        35.78168797918116
    ],
    [
        1619827200000,
        36.55581656201138
    ],
    [
        1619913600000,
        36.895496256261175
    ],
    [
        1620000000000,
        36.6285627722494
    ],
    [
        1620086400000,
        37.31086830197741
    ],
    [
        1620172800000,
        34.66179715014015
    ],
    [
        1620259200000,
        40.56852655266073
    ],
    [
        1620345600000,
        41.51515689478929
    ],
    [
        1620432000000,
        39.929559186608884
    ],
    [
        1620518400000,
        39.64457142823194
    ],
    [
        1620604800000,
        40.30508802482359
    ],
    [
        1620691200000,
        36.69757742138309
    ],
    [
        1620777600000,
        38.629214072066546
    ],
    [
        1620864000000,
        35.36632136089033
    ],
    [
        1620950400000,
        40.104540401272516
    ],
    [
        1621036800000,
        47.332353635705644
    ],
    [
        1621123200000,
        43.190023148615246
    ],
    [
        1621209600000,
        42.495607764845325
    ],
    [
        1621296000000,
        38.46656477354152
    ],
    [
        1621382400000,
        40.78449482314308
    ],
    [
        1621468800000,
        25.54743108791691
    ],
    [
        1621555200000,
        28.967655743659353
    ],
    [
        1621641600000,
        23.886862196760713
    ],
    [
        1621728000000,
        21.986431379821404
    ],
    [
        1621814400000,
        18.055571726141213
    ],
    [
        1621900800000,
        23.068256289923756
    ],
    [
        1621987200000,
        21.997749037507997
    ],
    [
        1622073600000,
        24.663574518122417
    ],
    [
        1622160000000,
        23.994031084550947
    ],
    [
        1622246400000,
        21.464260992226066
    ],
    [
        1622332800000,
        19.918216681542294
    ],
    [
        1622419200000,
        20.42812252465196
    ],
    [
        1622505600000,
        23.328086584213068
    ],
    [
        1622592000000,
        22.902544778389903
    ],
    [
        1622678400000,
        26.167284395860875
    ],
    [
        1622764800000,
        27.234938171421856
    ],
    [
        1622851200000,
        25.10056065061593
    ],
    [
        1622937600000,
        23.815643608975247
    ],
    [
        1623024000000,
        24.145890051847427
    ],
    [
        1623110400000,
        21.39739256988473
    ],
    [
        1623196800000,
        21.865193511951766
    ],
    [
        1623283200000,
        23.196555046160704
    ],
    [
        1623369600000,
        22.680029341910497
    ],
    [
        1623456000000,
        21.056524698640047
    ],
    [
        1623542400000,
        20.847240009628234
    ],
    [
        1623628800000,
        22.088991123662673
    ],
    [
        1623715200000,
        25.93495744173237
    ],
    [
        1623801600000,
        24.11981873706437
    ],
    [
        1623888000000,
        22.83454099821231
    ],
    [
        1623974400000,
        22.554291981739443
    ],
    [
        1624060800000,
        21.455255969499717
    ],
    [
        1624147200000,
        20.382325917766163
    ],
    [
        1624233600000,
        20.744845672595986
    ],
    [
        1624320000000,
        15.781535531442344
    ],
    [
        1624406400000,
        14.627751874192958
    ],
    [
        1624492800000,
        15.861423175287621
    ],
    [
        1624579200000,
        16.262421022046162
    ],
    [
        1624665600000,
        14.747592275574856
    ],
    [
        1624752000000,
        14.41927250471979
    ],
    [
        1624838400000,
        14.976084280991744
    ],
    [
        1624924800000,
        15.775887722002627
    ],
    [
        1625011200000,
        16.279041729818577
    ],
    [
        1625097600000,
        16.412002192338434
    ],
    [
        1625184000000,
        15.281224095869002
    ],
    [
        1625270400000,
        15.342281439549721
    ],
    [
        1625356800000,
        15.507857021418484
    ],
    [
        1625443200000,
        16.029758819607352
    ],
    [
        1625529600000,
        15.31885654020041
    ],
    [
        1625616000000,
        16.01125441862346
    ],
    [
        1625702400000,
        16.84380170366391
    ],
    [
        1625788800000,
        15.380429468503015
    ],
    [
        1625875200000,
        15.732674730640067
    ],
    [
        1625961600000,
        15.36268352922368
    ],
    [
        1626048000000,
        15.51696017943959
    ],
    [
        1626134400000,
        14.934794068404925
    ],
    [
        1626220800000,
        14.143113801682961
    ],
    [
        1626307200000,
        13.797801649099958
    ],
    [
        1626393600000,
        13.04247296885441
    ],
    [
        1626480000000,
        12.016875287601096
    ],
    [
        1626566400000,
        12.274409909483534
    ],
    [
        1626652800000,
        12.77284725809809
    ],
    [
        1626739200000,
        11.539037723699147
    ],
    [
        1626825600000,
        11.0743355718571
    ],
    [
        1626912000000,
        12.401542039727646
    ],
    [
        1626998400000,
        13.262281874766463
    ],
    [
        1627084800000,
        13.351105190817131
    ],
    [
        1627171200000,
        13.846756807214286
    ],
    [
        1627257600000,
        13.80111075819321
    ],
    [
        1627344000000,
        13.94463912061858
    ],
    [
        1627430400000,
        14.326005804928336
    ],
    [
        1627516800000,
        14.543284734722445
    ],
    [
        1627603200000,
        15.236569038715562
    ],
    [
        1627689600000,
        15.791851834578114
    ],
    [
        1627776000000,
        16.912525912521748
    ],
    [
        1627862400000,
        18.3233458957442
    ],
    [
        1627948800000,
        18.18533098596882
    ],
    [
        1628035200000,
        17.471733267876886
    ],
    [
        1628121600000,
        19.1805497367464
    ],
    [
        1628208000000,
        19.140041901139753
    ],
    [
        1628294400000,
        20.42446316253671
    ],
    [
        1628380800000,
        21.035247716871766
    ],
    [
        1628467200000,
        19.742707991682025
    ],
    [
        1628553600000,
        20.62804403556566
    ],
    [
        1628640000000,
        20.653509906705782
    ],
    [
        1628726400000,
        21.37773202804451
    ],
    [
        1628812800000,
        20.762374234824012
    ],
    [
        1628899200000,
        22.604203176061617
    ],
    [
        1628985600000,
        22.844915663284972
    ],
    [
        1629072000000,
        23.111421610258507
    ],
    [
        1629158400000,
        24.505600114092154
    ],
    [
        1629244800000,
        23.475585881540784
    ],
    [
        1629331200000,
        24.217998883334403
    ],
    [
        1629417600000,
        26.39307969821538
    ],
    [
        1629504000000,
        28.11162896524324
    ],
    [
        1629590400000,
        27.98249951438773
    ],
    [
        1629676800000,
        27.76421923953403
    ],
    [
        1629763200000,
        27.874502464277274
    ],
    [
        1629849600000,
        25.155027283169083
    ],
    [
        1629936000000,
        26.047207844402855
    ],
    [
        1630022400000,
        24.3643860162625
    ],
    [
        1630108800000,
        26.547837050599668
    ],
    [
        1630195200000,
        25.99098096746212
    ],
    [
        1630281600000,
        25.776588868303357
    ],
    [
        1630368000000,
        26.00661198004802
    ],
    [
        1630454400000,
        31.69534711952069
    ],
    [
        1630540800000,
        32.97277073071684
    ],
    [
        1630627200000,
        31.864305506316025
    ],
    [
        1630713600000,
        33.43097155843943
    ],
    [
        1630800000000,
        32.488914403134835
    ],
    [
        1630886400000,
        34.274432165434725
    ],
    [
        1630972800000,
        34.22739903407088
    ],
    [
        1631059200000,
        27.926488890687644
    ],
    [
        1631145600000,
        27.531978243944284
    ],
    [
        1631232000000,
        29.689510289564407
    ],
    [
        1631318400000,
        28.996715238323496
    ],
    [
        1631404800000,
        31.43064687183972
    ],
    [
        1631491200000,
        35.75990641335851
    ],
    [
        1631577600000,
        34.81777544563242
    ],
    [
        1631664000000,
        37.53172439963404
    ],
    [
        1631750400000,
        36.32933883533318
    ],
    [
        1631836800000,
        35.549524255890255
    ],
    [
        1631923200000,
        33.09227314887529
    ],
    [
        1632009600000,
        34.934410728513505
    ],
    [
        1632096000000,
        33.7407233723622
    ],
    [
        1632182400000,
        28.333626600911884
    ],
    [
        1632268800000,
        25.942043886237556
    ],
    [
        1632355200000,
        31.41067815412838
    ],
    [
        1632441600000,
        33.464521782542995
    ],
    [
        1632528000000,
        30.768722950317553
    ],
    [
        1632614400000,
        30.04378117695469
    ],
    [
        1632700800000,
        28.739701317904686
    ],
    [
        1632787200000,
        27.67820657740941
    ],
    [
        1632873600000,
        26.225564399871853
    ],
    [
        1632960000000,
        27.327637141304375
    ],
    [
        1633046400000,
        28.618114087839533
    ],
    [
        1633132800000,
        31.978847883259032
    ],
    [
        1633219200000,
        32.19539836627864
    ],
    [
        1633305600000,
        32.200486900159035
    ],
    [
        1633392000000,
        31.185245935073066
    ],
    [
        1633478400000,
        31.541054456229364
    ],
    [
        1633564800000,
        32.485705866217415
    ],
    [
        1633651200000,
        33.83145977239081
    ],
    [
        1633737600000,
        33.370044760833935
    ],
    [
        1633824000000,
        36.373698468386564
    ],
    [
        1633910400000,
        34.34298721225934
    ],
    [
        1633996800000,
        34.113785679254384
    ],
    [
        1634083200000,
        35.13048155416554
    ],
    [
        1634169600000,
        41.72781217437264
    ],
    [
        1634256000000,
        40.720592122011716
    ],
    [
        1634342400000,
        43.5866296137355
    ],
    [
        1634428800000,
        41.968290433109175
    ],
    [
        1634515200000,
        42.12994623897843
    ],
    [
        1634601600000,
        41.14152379788144
    ],
    [
        1634688000000,
        41.420230493727836
    ],
    [
        1634774400000,
        44.55324022965871
    ],
    [
        1634860800000,
        43.00191330948035
    ],
    [
        1634947200000,
        43.76861008364971
    ],
    [
        1635033600000,
        44.12639396425712
    ],
    [
        1635120000000,
        42.52360241274431
    ],
    [
        1635206400000,
        44.59331921239614
    ],
    [
        1635292800000,
        45.302770817549685
    ],
    [
        1635379200000,
        40.48819618495527
    ],
    [
        1635465600000,
        42.073440498286715
    ],
    [
        1635552000000,
        44.12376816409454
    ],
    [
        1635638400000,
        42.736192329791095
    ],
    [
        1635724800000,
        42.81690939370991
    ],
    [
        1635811200000,
        50.09269045865121
    ],
    [
        1635897600000,
        51.27829191261836
    ],
    [
        1635984000000,
        53.33615766815946
    ],
    [
        1636070400000,
        54.14285984546231
    ],
    [
        1636156800000,
        51.990745657999035
    ],
    [
        1636243200000,
        52.07770442889012
    ],
    [
        1636329600000,
        52.39636639694776
    ],
    [
        1636416000000,
        53.39305737496087
    ],
    [
        1636502400000,
        50.96942903851561
    ],
    [
        1636588800000,
        46.99648883017275
    ],
    [
        1636675200000,
        47.82785067139819
    ],
    [
        1636761600000,
        46.11537592517483
    ],
    [
        1636848000000,
        47.275224791841616
    ],
    [
        1636934400000,
        46.591442711863266
    ],
    [
        1637020800000,
        44.93714053035325
    ],
    [
        1637107200000,
        41.18319811384895
    ],
    [
        1637193600000,
        42.6861490104601
    ],
    [
        1637280000000,
        38.926188899913996
    ],
    [
        1637366400000,
        41.42920166167476
    ],
    [
        1637452800000,
        42.184786086687964
    ],
    [
        1637539200000,
        42.58084389913225
    ],
    [
        1637625600000,
        39.460313920693075
    ],
    [
        1637712000000,
        40.89380081135477
    ],
    [
        1637798400000,
        38.338259845831686
    ],
    [
        1637884800000,
        39.3973876308258
    ],
    [
        1637971200000,
        34.607328982708594
    ],
    [
        1638057600000,
        34.95133852170145
    ],
    [
        1638144000000,
        35.64442850483728
    ],
    [
        1638230400000,
        37.1882620027123
    ],
    [
        1638316800000,
        38.003426416904354
    ],
    [
        1638403200000,
        36.69905708848537
    ],
    [
        1638489600000,
        35.72071372962105
    ],
    [
        1638576000000,
        33.797058582536444
    ],
    [
        1638662400000,
        29.277802791950165
    ],
    [
        1638748800000,
        28.290659708129795
    ],
    [
        1638835200000,
        28.275803567681336
    ],
    [
        1638921600000,
        30.343726589287844
    ],
    [
        1639008000000,
        29.81682528014429
    ],
    [
        1639094400000,
        27.014186624811703
    ],
    [
        1639180800000,
        26.557637832512125
    ],
    [
        1639267200000,
        27.74464744086527
    ],
    [
        1639353600000,
        29.5600373761154
    ],
    [
        1639440000000,
        25.932313811594845
    ],
    [
        1639526400000,
        26.181983524343526
    ],
    [
        1639612800000,
        27.231332106149466
    ],
    [
        1639699200000,
        26.002561395415963
    ],
    [
        1639785600000,
        24.765112114316356
    ],
    [
        1639872000000,
        25.55648562112267
    ],
    [
        1639958400000,
        24.802747465478337
    ],
    [
        1640044800000,
        24.23642926385144
    ],
    [
        1640131200000,
        25.274795319137755
    ],
    [
        1640217600000,
        27.288277179201177
    ],
    [
        1640304000000,
        29.239632207049347
    ],
    [
        1640390400000,
        28.157889269866587
    ],
    [
        1640476800000,
        28.94915717480624
    ],
    [
        1640563200000,
        31.420552375463284
    ],
    [
        1640649600000,
        31.046054786643506
    ],
    [
        1640736000000,
        28.030041142425592
    ],
    [
        1640822400000,
        26.746921410551437
    ],
    [
        1640908800000,
        27.53836772217654
    ],
    [
        1640995200000,
        26.737095973322056
    ],
    [
        1641081600000,
        28.641423056433503
    ],
    [
        1641168000000,
        29.76663909151273
    ],
    [
        1641254400000,
        30.15170108918123
    ],
    [
        1641340800000,
        28.85560896706936
    ],
    [
        1641427200000,
        26.88794754649635
    ],
    [
        1641513600000,
        26.81810933164343
    ],
    [
        1641600000000,
        24.966617574613622
    ],
    [
        1641686400000,
        24.051793062157824
    ],
    [
        1641772800000,
        24.65132946490016
    ],
    [
        1641859200000,
        23.773314178362128
    ],
    [
        1641945600000,
        25.549876615214746
    ],
    [
        1642032000000,
        27.349144715858582
    ],
    [
        1642118400000,
        25.836341318657578
    ],
    [
        1642204800000,
        27.748763536504455
    ],
    [
        1642291200000,
        27.778986859944954
    ],
    [
        1642377600000,
        27.738117191121205
    ],
    [
        1642464000000,
        25.751505858215815
    ],
    [
        1642550400000,
        25.118053411006642
    ],
    [
        1642636800000,
        24.162781364500326
    ],
    [
        1642723200000,
        23.024331211171255
    ],
    [
        1642809600000,
        19.574187609576683
    ],
    [
        1642896000000,
        18.28708783426802
    ],
    [
        1642982400000,
        18.802671156939812
    ],
    [
        1643068800000,
        18.126485578434096
    ],
    [
        1643155200000,
        18.5395852346935
    ],
    [
        1643241600000,
        18.10492562402364
    ],
    [
        1643328000000,
        18.18946807468125
    ],
    [
        1643414400000,
        18.372851407945653
    ],
    [
        1643500800000,
        18.76352083387839
    ],
    [
        1643587200000,
        18.221536871514516
    ],
    [
        1643673600000,
        19.456703840135145
    ],
    [
        1643760000000,
        19.64032263624118
    ],
    [
        1643846400000,
        18.84269861214864
    ],
    [
        1643932800000,
        18.76318690237329
    ],
    [
        1644019200000,
        20.493714841425078
    ],
    [
        1644105600000,
        21.410655041263617
    ],
    [
        1644192000000,
        21.93454476389413
    ],
    [
        1644278400000,
        22.421151190170697
    ],
    [
        1644364800000,
        21.716960262761894
    ],
    [
        1644451200000,
        21.958282792374536
    ],
    [
        1644537600000,
        20.665904642186753
    ],
    [
        1644624000000,
        18.98356987116232
    ],
    [
        1644710400000,
        18.815152462515293
    ],
    [
        1644796800000,
        18.840796816073365
    ],
    [
        1644883200000,
        18.732314169743915
    ],
    [
        1644969600000,
        20.167527228360353
    ],
    [
        1645056000000,
        19.831693104156717
    ],
    [
        1645142400000,
        18.123878114571923
    ],
    [
        1645228800000,
        17.86887473067776
    ],
    [
        1645315200000,
        17.926197744256044
    ],
    [
        1645401600000,
        16.948377603477436
    ],
    [
        1645488000000,
        16.212967526787747
    ],
    [
        1645574400000,
        16.581915190362093
    ],
    [
        1645660800000,
        16.036832530428047
    ],
    [
        1645747200000,
        16.104118842758016
    ],
    [
        1645833600000,
        17.310035168644806
    ],
    [
        1645920000000,
        18.006637522495673
    ],
    [
        1646006400000,
        17.51614278663639
    ],
    [
        1646092800000,
        18.943247857401634
    ],
    [
        1646179200000,
        18.87702635955203
    ],
    [
        1646265600000,
        18.608045948712572
    ],
    [
        1646352000000,
        18.03471783366769
    ],
    [
        1646438400000,
        16.784881153845042
    ],
    [
        1646524800000,
        17.330377141911068
    ],
    [
        1646611200000,
        17.01198949977739
    ],
    [
        1646697600000,
        16.426913670743733
    ],
    [
        1646784000000,
        16.945346784357945
    ],
    [
        1646870400000,
        17.876245857159546
    ],
    [
        1646956800000,
        16.985958823787616
    ],
    [
        1647043200000,
        17.743647828145413
    ],
    [
        1647129600000,
        18.150935728455433
    ],
    [
        1647216000000,
        17.234219464598677
    ],
    [
        1647302400000,
        17.68738785594418
    ],
    [
        1647388800000,
        17.828163307983015
    ],
    [
        1647475200000,
        19.055584448057218
    ],
    [
        1647561600000,
        18.755074123220062
    ],
    [
        1647648000000,
        19.01395775408254
    ],
    [
        1647734400000,
        19.34596806110183
    ],
    [
        1647820800000,
        18.64579860180783
    ],
    [
        1647907200000,
        18.788263823872484
    ],
    [
        1647993600000,
        20.365777074518867
    ],
    [
        1648080000000,
        20.980470549502094
    ],
    [
        1648166400000,
        21.210356404656093
    ],
    [
        1648252800000,
        20.547025200525564
    ],
    [
        1648339200000,
        20.8739438123419
    ],
    [
        1648425600000,
        22.38661684964733
    ],
    [
        1648512000000,
        21.914457883187087
    ],
    [
        1648598400000,
        22.403552309898593
    ],
    [
        1648684800000,
        22.512011785197572
    ],
    [
        1648771200000,
        21.318705302764997
    ],
    [
        1648857600000,
        21.996761615732268
    ],
    [
        1648944000000,
        22.684900908599285
    ],
    [
        1649030400000,
        23.193205512290056
    ],
    [
        1649116800000,
        22.560434275454405
    ],
    [
        1649203200000,
        21.843016612182463
    ],
    [
        1649289600000,
        19.89700107558607
    ],
    [
        1649376000000,
        20.441624053567306
    ],
    [
        1649462400000,
        19.3675905584022
    ],
    [
        1649548800000,
        19.792656880328018
    ],
    [
        1649635200000,
        19.331487558951697
    ],
    [
        1649721600000,
        17.182499771391125
    ],
    [
        1649808000000,
        17.817527483368114
    ],
    [
        1649894400000,
        18.206153438222977
    ],
    [
        1649980800000,
        17.954475956169055
    ],
    [
        1650067200000,
        18.379594847435794
    ],
    [
        1650153600000,
        18.660527306495563
    ],
    [
        1650240000000,
        17.783716538513406
    ],
    [
        1650326400000,
        18.178777088900517
    ],
    [
        1650412800000,
        18.89087581721998
    ],
    [
        1650499200000,
        19.088467611153188
    ],
    [
        1650585600000,
        18.18472037750706
    ],
    [
        1650672000000,
        18.31857023588711
    ],
    [
        1650758400000,
        18.741319387866202
    ],
    [
        1650844800000,
        18.160653932275427
    ],
    [
        1650931200000,
        18.128100926600588
    ],
    [
        1651017600000,
        16.610705695593627
    ],
    [
        1651104000000,
        16.93827653241623
    ],
    [
        1651190400000,
        16.982954466317672
    ],
    [
        1651276800000,
        16.17424077241381
    ],
    [
        1651363200000,
        14.569888162040202
    ],
    [
        1651449600000,
        15.41877382499901
    ],
    [
        1651536000000,
        14.992753076070642
    ],
    [
        1651622400000,
        14.727361922722716
    ],
    [
        1651708800000,
        16.292368065665716
    ],
    [
        1651795200000,
        14.598846299024533
    ],
    [
        1651881600000,
        14.355717785177836
    ],
    [
        1651968000000,
        13.800376804821555
    ],
    [
        1652054400000,
        13.22936099121686
    ],
    [
        1652140800000,
        10.801429785440924
    ],
    [
        1652227200000,
        11.325014505908833
    ],
    [
        1652313600000,
        8.901204052865326
    ],
    [
        1652400000000,
        8.769325238296613
    ],
    [
        1652486400000,
        10.4879764448722
    ],
    [
        1652572800000,
        11.37609195242141
    ],
    [
        1652659200000,
        11.800640817629374
    ],
    [
        1652745600000,
        10.661734977316367
    ],
    [
        1652832000000,
        11.053819427499075
    ],
    [
        1652918400000,
        9.517212484127024
    ],
    [
        1653004800000,
        10.07163545677334
    ],
    [
        1653091200000,
        9.695758499813333
    ],
    [
        1653177600000,
        9.99688541163415
    ],
    [
        1653264000000,
        10.189629881421922
    ],
    [
        1653350400000,
        9.917950994206555
    ],
    [
        1653436800000,
        10.197008650448218
    ],
    [
        1653523200000,
        9.855449944611918
    ],
    [
        1653609600000,
        9.198261981785189
    ],
    [
        1653696000000,
        9.13874862040733
    ],
    [
        1653782400000,
        9.695152233273474
    ],
    [
        1653868800000,
        9.986166924880612
    ],
    [
        1653955200000,
        10.461842809318215
    ],
    [
        1654041600000,
        10.448283148141524
    ],
    [
        1654128000000,
        9.484222468578501
    ],
    [
        1654214400000,
        9.896299945398498
    ],
    [
        1654300800000,
        9.372006368573782
    ],
    [
        1654387200000,
        9.436263733449623
    ],
    [
        1654473600000,
        9.338347728064072
    ],
    [
        1654560000000,
        9.472049966781283
    ],
    [
        1654646400000,
        9.245287369128352
    ],
    [
        1654732800000,
        9.000860375425932
    ],
    [
        1654819200000,
        9.224408429940054
    ],
    [
        1654905600000,
        8.656938948250048
    ],
    [
        1654992000000,
        8.007773894291699
    ],
    [
        1655078400000,
        7.450027957000497
    ],
    [
        1655164800000,
        7.001810875279709
    ],
    [
        1655251200000,
        7.379032716449845
    ],
    [
        1655337600000,
        8.516714356116118
    ],
    [
        1655424000000,
        7.105844592665794
    ],
    [
        1655510400000,
        7.325464174931059
    ],
    [
        1655596800000,
        7.068027828135199
    ],
    [
        1655683200000,
        7.504558358292622
    ],
    [
        1655769600000,
        7.894626280316918
    ],
    [
        1655856000000,
        7.736855254831152
    ],
    [
        1655942400000,
        7.419624804433869
    ],
    [
        1656028800000,
        7.806285623861093
    ],
    [
        1656115200000,
        8.21567426052568
    ],
    [
        1656201600000,
        8.135501883565913
    ],
    [
        1656288000000,
        7.861850137967533
    ],
    [
        1656374400000,
        7.72479055629487
    ],
    [
        1656460800000,
        7.29512308847008
    ],
    [
        1656547200000,
        7.002323505207497
    ],
    [
        1656633600000,
        6.970042715539203
    ],
    [
        1656720000000,
        6.789762340578334
    ],
    [
        1656806400000,
        6.827235670454218
    ],
    [
        1656892800000,
        6.849241180089714
    ],
    [
        1656979200000,
        7.169210518110505
    ],
    [
        1657065600000,
        6.840206443166161
    ],
    [
        1657152000000,
        6.932599081682027
    ],
    [
        1657238400000,
        7.320223383970988
    ],
    [
        1657324800000,
        7.138690731338326
    ],
    [
        1657411200000,
        7.2620836518951455
    ],
    [
        1657497600000,
        6.853636299733879
    ],
    [
        1657584000000,
        6.548562170533149
    ],
    [
        1657670400000,
        6.299920689741761
    ],
    [
        1657756800000,
        6.466718030554244
    ],
    [
        1657843200000,
        6.722033479422479
    ],
    [
        1657929600000,
        6.803514529364242
    ],
    [
        1658016000000,
        7.1806583122276795
    ],
    [
        1658102400000,
        6.941678186836009
    ],
    [
        1658188800000,
        7.663547079988968
    ],
    [
        1658275200000,
        7.805428675874703
    ],
    [
        1658361600000,
        7.494747923839123
    ],
    [
        1658448000000,
        7.522307681331509
    ],
    [
        1658534400000,
        7.305335424196388
    ],
    [
        1658620800000,
        7.350939101233989
    ],
    [
        1658707200000,
        7.418171973435616
    ],
    [
        1658793600000,
        6.801378054710406
    ],
    [
        1658880000000,
        6.761483215626529
    ],
    [
        1658966400000,
        7.561940666246688
    ],
    [
        1659052800000,
        7.856758845650289
    ],
    [
        1659139200000,
        8.254099425235934
    ],
    [
        1659225600000,
        8.223237506460018
    ],
    [
        1659312000000,
        8.676722318164812
    ],
    [
        1659398400000,
        8.182566038730137
    ],
    [
        1659484800000,
        7.987130875742656
    ],
    [
        1659571200000,
        8.019968326257795
    ],
    [
        1659657600000,
        8.105913518219932
    ],
    [
        1659744000000,
        8.782313243874109
    ],
    [
        1659830400000,
        8.535766619734408
    ],
    [
        1659916800000,
        8.645826921981477
    ],
    [
        1660003200000,
        9.293793478167027
    ],
    [
        1660089600000,
        8.907662578820101
    ],
    [
        1660176000000,
        9.488815023023541
    ],
    [
        1660262400000,
        9.201884659413661
    ],
    [
        1660348800000,
        9.480567462863045
    ],
    [
        1660435200000,
        9.304670048983118
    ],
    [
        1660521600000,
        8.955954355161216
    ],
    [
        1660608000000,
        8.811939800005115
    ],
    [
        1660694400000,
        8.863559569845178
    ],
    [
        1660780800000,
        8.370952417932997
    ],
    [
        1660867200000,
        8.104153247573388
    ],
    [
        1660953600000,
        7.336196407991564
    ],
    [
        1661040000000,
        7.234957915613337
    ],
    [
        1661126400000,
        7.456335865567314
    ],
    [
        1661212800000,
        7.402169823069187
    ],
    [
        1661299200000,
        7.65794979782759
    ],
    [
        1661385600000,
        7.581044670572473
    ],
    [
        1661472000000,
        7.59438701810938
    ],
    [
        1661558400000,
        6.937489346438347
    ],
    [
        1661644800000,
        7.062807230819954
    ],
    [
        1661731200000,
        6.895424792064857
    ],
    [
        1661817600000,
        7.290118968272859
    ],
    [
        1661904000000,
        6.984391608517394
    ],
    [
        1661990400000,
        7.019343630471642
    ],
    [
        1662076800000,
        7.193081069206047
    ],
    [
        1662163200000,
        7.3019734403613725
    ],
    [
        1662249600000,
        7.276799953721473
    ],
    [
        1662336000000,
        7.374550409292204
    ],
    [
        1662422400000,
        7.362505243906269
    ],
    [
        1662508800000,
        6.892565163556254
    ],
    [
        1662595200000,
        7.202308390586858
    ],
    [
        1662681600000,
        7.395360164932129
    ],
    [
        1662768000000,
        7.762750555283015
    ],
    [
        1662854400000,
        7.794452310539513
    ],
    [
        1662940800000,
        7.685712587696711
    ],
    [
        1663027200000,
        7.643022794488279
    ],
    [
        1663113600000,
        7.0851159860761745
    ],
    [
        1663200000000,
        7.213760436420992
    ],
    [
        1663286400000,
        6.925994666672714
    ],
    [
        1663372800000,
        6.885169664119995
    ],
    [
        1663459200000,
        7.062033609787554
    ],
    [
        1663545600000,
        6.451319275569396
    ],
    [
        1663632000000,
        6.400147682393467
    ],
    [
        1663718400000,
        6.2735544717347125
    ],
    [
        1663804800000,
        6.15507954434087
    ],
    [
        1663891200000,
        6.459199231132459
    ],
    [
        1663977600000,
        6.4387239867675765
    ],
    [
        1664064000000,
        6.279193352283581
    ],
    [
        1664150400000,
        6.2090362798894345
    ],
    [
        1664236800000,
        6.537305452547308
    ],
    [
        1664323200000,
        6.385907691464419
    ],
    [
        1664409600000,
        6.402230753147547
    ],
    [
        1664496000000,
        6.424362258931859
    ],
    [
        1664582400000,
        6.318884540630228
    ],
    [
        1664668800000,
        6.270177916210261
    ],
    [
        1664755200000,
        6.175004031977384
    ],
    [
        1664841600000,
        6.382121662764067
    ],
    [
        1664928000000,
        6.495634012286242
    ],
    [
        1665014400000,
        6.434243088786229
    ],
    [
        1665100800000,
        6.335205166710474
    ],
    [
        1665187200000,
        6.303039128782252
    ],
    [
        1665273600000,
        6.3072484298727955
    ],
    [
        1665360000000,
        6.474215515030945
    ],
    [
        1665446400000,
        6.261375650357296
    ],
    [
        1665532800000,
        6.178437206667696
    ],
    [
        1665619200000,
        6.170286131792819
    ],
    [
        1665705600000,
        6.118107126071069
    ],
    [
        1665792000000,
        6.0482969336456796
    ],
    [
        1665878400000,
        6.053848659488938
    ],
    [
        1665964800000,
        6.187909002854843
    ],
    [
        1666051200000,
        6.26190922076587
    ],
    [
        1666137600000,
        6.159840950533676
    ],
    [
        1666224000000,
        6.100192535102491
    ],
    [
        1666310400000,
        5.879164097467845
    ],
    [
        1666396800000,
        5.831333073776765
    ],
    [
        1666483200000,
        5.849650890164364
    ],
    [
        1666569600000,
        5.959396740320037
    ],
    [
        1666656000000,
        5.908162457565343
    ],
    [
        1666742400000,
        6.4487343859863415
    ],
    [
        1666828800000,
        6.472561100006428
    ],
    [
        1666915200000,
        6.341407609886782
    ],
    [
        1667001600000,
        6.520146600462493
    ],
    [
        1667088000000,
        6.628612882300657
    ],
    [
        1667174400000,
        6.646905931405313
    ],
    [
        1667260800000,
        6.629761481159746
    ],
    [
        1667347200000,
        6.470919304139706
    ],
    [
        1667433600000,
        6.248053129263109
    ],
    [
        1667520000000,
        6.420972532569684
    ],
    [
        1667606400000,
        7.070667814964063
    ],
    [
        1667692800000,
        7.019881861679114
    ],
    [
        1667779200000,
        6.8191786227324425
    ],
    [
        1667865600000,
        7.119434896729182
    ],
    [
        1667952000000,
        6.305819529634667
    ],
    [
        1668038400000,
        5.387935014686499
    ],
    [
        1668124800000,
        5.959795503990238
    ],
    [
        1668211200000,
        5.777985907411939
    ],
    [
        1668297600000,
        5.77407449492291
    ],
    [
        1668384000000,
        5.751572408119209
    ],
    [
        1668470400000,
        5.862457337190748
    ],
    [
        1668556800000,
        5.924926486568587
    ],
    [
        1668643200000,
        5.7227420952101085
    ],
    [
        1668729600000,
        5.681003680598559
    ],
    [
        1668816000000,
        5.645948553150153
    ],
    [
        1668902400000,
        5.607460544771688
    ],
    [
        1668988800000,
        5.299733010902535
    ],
    [
        1669075200000,
        5.199655615266775
    ],
    [
        1669161600000,
        5.273028337640404
    ],
    [
        1669248000000,
        5.443165190559928
    ],
    [
        1669334400000,
        5.388974510527179
    ],
    [
        1669420800000,
        5.2749698281683015
    ],
    [
        1669507200000,
        5.302373502924272
    ],
    [
        1669593600000,
        5.303442076324324
    ],
    [
        1669680000000,
        5.133673027053566
    ],
    [
        1669766400000,
        5.3128897441199125
    ],
    [
        1669852800000,
        5.477993642012171
    ],
    [
        1669939200000,
        5.400486331935812
    ],
    [
        1670025600000,
        5.648105069152116
    ],
    [
        1670112000000,
        5.504915282161034
    ],
    [
        1670198400000,
        5.606038163070065
    ],
    [
        1670284800000,
        5.492117706618971
    ],
    [
        1670324446000,
        5.460345034343501
    ]
]



@Injectable({providedIn: 'root'})
export class PricingService {
  price: Subject<null | number> = new ReplaySubject(1);

  currency: string | null;
  network: string | null;
  interval: number | null;

  dailyHistoricPrices = new BehaviorSubject<[number, number][]>(test);
  // dailyHistoricPrices = new BehaviorSubject<[number, number][]>([]);

  constructor(private pa: PolkadaptService,
              private vs: VariablesService) {
    this.price.subscribe(this.vs.price);

    window.addEventListener('online', () => this.startPriceWatch());
    window.addEventListener('offline', () => this.stopPriceWatch());
  }


  async initialize(network: string, currency: string): Promise<void> {
    if (!network) {
      throw new Error(`[PricingService] initialize: network was not provided.`);
    }

    if (!currency) {
      throw new Error(`[PricingService] initialize: currency was not provided.`);
    }

    this.network = network;
    this.currency = currency;
    this.price.next(null);

    this.fetchAndSetPrice();
    this.startPriceWatch();
    this.fetchDailyHistoricPrices();
  }


  async destroy(): Promise<void> {
    this.stopPriceWatch();
    this.network = null;
    this.currency = null;
    this.price.next(null);
    this.dailyHistoricPrices.next([]);
  }


  async startPriceWatch(): Promise<void> {
      this.interval = window.setInterval(async () => {
        this.fetchAndSetPrice();
      }, 15000);
  }


  stopPriceWatch(): void {
    if (this.interval) {
      clearInterval(this.interval);
      this.interval = null;
    }
  }


  async fetchAndSetPrice(): Promise<void> {
    try {
      const adapterAvailable = await this.pa.availableAdapters[this.network as string].coingeckoApi.isReady;
      if (adapterAvailable) {
        const price = await this.pa.run(this.network as string).prices.getPrice(this.currency as string);

        if (this.interval) {
          // Only set price if not destroyed.
          this.price.next(price as number);
        }
      }
    } catch (e) {
      this.price.next(null);
      // console.error(e);
    }
  }

  async fetchDailyHistoricPrices(): Promise<void> {
    try {
      const adapterAvailable = await this.pa.availableAdapters[this.network as string].coingeckoApi.isReady;
      if (adapterAvailable) {
        const history = await this.pa.run(this.network as string).prices.getHistoricalPrices(this.currency as string, 'max');
        if (history) {
          this.dailyHistoricPrices.next(history);
        }
      }
    } catch (e) {
      console.error(e);
    }
  }
}
